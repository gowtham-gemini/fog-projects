//>>built
define("dojox/charting/plot2d/Bars","dojo/_base/kernel,dojo/_base/lang,dojo/_base/array,dojo/_base/declare,./CartesianBase,./_PlotEvents,./common,dojox/gfx/fx,dojox/lang/utils,dojox/lang/functional,dojox/lang/functional/reversed".split(","),function(E,r,v,s,t,z,l,A,n,B,C){var D=C.lambda("item.purgeGroup()");return s("dojox.charting.plot2d.Bars",[t,z],{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null,enableCache:!1},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},
styleFunc:null,font:"",fontColor:""},constructor:function(a,c){this.opt=r.clone(this.defaultParams);n.updateWithObject(this.opt,c);n.updateWithPattern(this.opt,c,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate},getSeriesStats:function(){var a=l.collectSimpleStats(this.series),c;a.hmin-=0.5;a.hmax+=0.5;c=a.hmin;a.hmin=a.vmin;a.vmin=c;c=a.hmax;a.hmax=a.vmax;a.vmax=c;return a},createRect:function(a,c,e){var f;this.opt.enableCache&&
0<a._rectFreePool.length?(f=a._rectFreePool.pop(),f.setShape(e),c.add(f)):f=c.createRect(e);this.opt.enableCache&&a._rectUsePool.push(f);return f},render:function(a,c){if(this.zoom&&!this.isDataDirty())return this.performZoom(a,c);this.dirty=this.isDirty();this.resetEvents();var e;if(this.dirty)v.forEach(this.series,D),this._eventSeries={},this.cleanGroup(),e=this.group,B.forEachRev(this.series,function(a){a.cleanGroup(e)});for(var f=this.chart.theme,l=this._hScaler.scaler.getTransformerFromModel(this._hScaler),
n=this._vScaler.scaler.getTransformerFromModel(this._vScaler),w=Math.max(0,this._hScaler.bounds.lower),o=l(w),s=this.events(),p=this.getBarProperties(),m=this.series.length-1;0<=m;--m){var b=this.series[m];if(!this.dirty&&!b.dirty)f.skip(),this._reconnectEvents(b.name);else{b.cleanGroup();if(this.opt.enableCache)b._rectFreePool=(b._rectFreePool?b._rectFreePool:[]).concat(b._rectUsePool?b._rectUsePool:[]),b._rectUsePool=[];var x=f.next("bar",[this.opt,b]),y=Array(b.data.length);e=b.group;for(var u=
v.some(b.data,function(a){return"number"==typeof a||a&&!a.hasOwnProperty("x")}),i=u?Math.max(0,Math.floor(this._vScaler.bounds.from-1)):0,t=u?Math.min(b.data.length,Math.ceil(this._vScaler.bounds.to)):b.data.length;i<t;++i){var d=b.data[i];if(null!=d){var h=this.getValue(d,i,m,u),j=l(h.y),q=Math.abs(j-o),g;if(this.opt.styleFunc||"number"!=typeof d){var k="number"!=typeof d?[d]:[];this.opt.styleFunc&&k.push(this.opt.styleFunc(d));d=f.addMixin(x,"bar",k,!0)}else d=f.post(x,"bar");if(0<=q&&1<=p.height)j=
{x:c.l+(h.y<w?j:o),y:a.height-c.b-n(h.x+1.5)+p.gap+p.thickness*(this.series.length-m-1),width:q,height:p.height},d.series.shadow&&(g=r.clone(j),g.x+=d.series.shadow.dx,g.y+=d.series.shadow.dy,g=this.createRect(b,e,g).setFill(d.series.shadow.color).setStroke(d.series.shadow),this.animate&&this._animateBar(g,c.l+o,-q)),k=this._plotFill(d.series.fill,a,c),k=this._shapeFill(k,j),d=this.createRect(b,e,j).setFill(k).setStroke(d.series.stroke),b.dyn.fill=d.getFill(),b.dyn.stroke=d.getStroke(),s&&(h={element:"bar",
index:i,run:b,shape:d,shadow:g,x:h.y,y:h.x+1.5},this._connectEvents(h),y[i]=h),this.animate&&this._animateBar(d,c.l+o,-q)}}this._eventSeries[b.name]=y;b.dirty=!1}}this.dirty=!1;return this},getValue:function(a,c,e,f){f?(e="number"==typeof a?a:a.y,a=c):(e=a.y,a=a.x-1);return{y:e,x:a}},getBarProperties:function(){var a=l.calculateBarSize(this._vScaler.bounds.scale,this.opt);return{gap:a.gap,height:a.size,thickness:0}},_animateBar:function(a,c,e){0==e&&(e=1);A.animateTransform(r.delegate({shape:a,duration:1200,
transform:[{name:"translate",start:[c-c/e,0],end:[0,0]},{name:"scale",start:[1/e,1],end:[1,1]},{name:"original"}]},this.animate)).play()}})});